package mpkprojekt;

import javax.swing.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;
import java.util.Random;

public class CSimulator {
    CJFrame jFrame = null;
    ArrayList <CTram> trams = new ArrayList<>();
    ArrayList<Objects> obj = new ArrayList<>();
    CLine line1 = new CLine("(0,0);(1,0);(2,0);(3,0);(4,0);(5,0);(6,0);(6,1);(6,2);(6,3);(6,4);(5,4);(4,4);(3,4);(2,4);(1,4);(0,4);(0,3);(0,2);(0,1)");
    CLine line4 = new CLine("(0,0);(1,0);(2,0);(3,0);(4,0);(5,0);(6,0);(7,0);(8,0);(9,0);(10,0);(11,0);(12,0);(12,1);(12,2);(12,3);(12,4);(12,5);(12,6);(12,7);(12,8);(11,8);(10,8);(9,8);(8,8);(7,8);(6,8);(5,8);(4,8);(3,8);(2,8);(1,8);(0,8);(0,7);(0,6);(0,5);(0,4);(0,3);(0,2);(0,1);(0,0)");
    CLine line10 = new CLine("(3,12);(3,13);(4,13);(4,14);(5,14);(5,15);(6,15);(6,16);(6,17);(6,18);(6,19);(6,20);(6,21);(6,22);(7,22);(8,22);(9,22);(10,22);(11,22);(12,22);(13,22);(14,22);(15,22);(16,22);(17,22);(18,22);(19,22);(19,23);(20,23);(21,23);(22,23);(23,23);(24,23);(25,23);(26,23);(26,24);(27,24);(28,24);(29,24);(30,24);(31,24);(32,24);(33,24);(34,24);(35,24);(36,24);(36,24);(36,25);(36,26);(36,27);(36,28);(36,29);(36,30);(36,31);(37,31);(38,31);(38,32);(39,32);(40,32);(40,33);(41,33);(42,33);(42,34);(43,34);(44,34);(45,34);(46,34);(47,34);(48,34);(49,34);(50,34);(51,34);(52,34);(53,34);(54,34);(55,34);(56,34);(56,35);(57,35);(58,35);(58,36);(59,36);(60,36);(61,36);(62,36);(63,36);(64,36);(65,36);(66,36);(67,36);(68,36);(69,36);(70,36);(71,36);(72,36);(73,36);(74,36);(75,36);(76,36);(77,36);(78,36);(79,36);(80,36);(81,36);(81,35);(82,35);(83,35);(84,35);(84,34);(85,34);(86,34);(87,34);(88,34);(89,34);(90,34);(91,34);(92,34);(93,34);(94,34);(95,34);(96,34);(96,34);(96,33);(96,32);(96,31);(96,30);(96,29);(96,28);(96,27);(96,26);(96,25);(97,25);(98,25);(99,25);(99,24);(99,23);(100,23);(101,23);(102,23);(103,23);(104,23);(105,23);(106,23);(107,23);(108,23);(109,23);(110,23);(111,23);(112,23);(113,23);(113,22);(114,22);(115,22);(116,22);(117,22);(118,22);(119,22);(120,22);(121,22);(121,23);(122,23);(123,23);(124,23);(125,23);(126,23);(127,23);(128,23);(129,23);(129,24);(129,25);(130,25);(131,25);(132,25);(133,25);(134,25);(135,25);(136,25);(137,25);(138,25);(139,25);(140,25);(141,25);(142,25);(143,25);(143,24);(142,24);(141,24);(140,24);(139,24);(138,24);(137,24);(136,24);(135,24);(134,24);(133,24);(132,24);(131,24);(130,24);(130,23);(130,22);(129,22);(128,22);(127,22);(126,22);(125,22);(124,22);(123,22);(122,22);(122,21);(121,21);(120,21);(119,21);(118,21);(117,21);(116,21);(115,21);(114,21);(113,21);(112,21);(112,22);(111,22);(110,22);(109,22);(108,22);(107,22);(106,22);(105,22);(104,22);(103,22);(102,22);(101,22);(100,22);(99,22);(98,22);(98,23);(98,24);(97,24);(96,24);(95,24);(95,25);(95,26);(95,27);(95,28);(95,29);(95,30);(95,31);(95,32);(95,33);(95,33);(94,33);(93,33);(92,33);(91,33);(90,33);(89,33);(88,33);(87,33);(86,33);(85,33);(84,33);(83,33);(83,34);(82,34);(81,34);(80,34);(80,35);(79,35);(78,35);(77,35);(76,35);(75,35);(74,35);(73,35);(72,35);(71,35);(70,35);(69,35);(68,35);(67,35);(66,35);(65,35);(64,35);(63,35);(62,35);(61,35);(60,35);(59,35);(59,34);(58,34);(57,34);(57,33);(56,33);(55,33);(54,33);(53,33);(52,33);(51,33);(50,33);(49,33);(48,33);(47,33);(46,33);(45,33);(44,33);(43,33);(43,32);(42,32);(41,32);(41,31);(40,31);(39,31);(39,30);(38,30);(37,30);(37,29);(37,28);(37,27);(37,26);(37,25);(37,24);(37,23);(37,23);(36,23);(35,23);(34,23);(33,23);(32,23);(31,23);(30,23);(29,23);(28,23);(27,23);(27,22);(26,22);(25,22);(24,22);(23,22);(22,22);(21,22);(20,22);(20,21);(19,21);(18,21);(17,21);(16,21);(15,21);(14,21);(13,21);(12,21);(11,21);(10,21);(9,21);(8,21);(7,21);(7,20);(7,19);(7,18);(7,17);(7,16);(7,15);(7,14);(6,14);(6,13);(5,13);(5,12);(4,12)");
    CLine line3 = new CLine("(50,0);(50,1);(50,2);(50,3);(50,4);(50,5);(50,6);(50,7);(50,8);(50,9);(50,10);(50,11);(50,12);(50,13);(50,14);(50,15);(50,16);(50,17);(50,18);(50,19);(50,20);(50,21);(50,22);(50,23);(50,24);(50,25);(50,26);(50,27);(50,28);(50,29);(50,30);(50,31);(50,32);(50,33);(50,34);(50,35);(50,36);(50,37);(50,38);(50,39);(50,40);(50,41);(50,42);(50,43);(50,44);(50,45);(50,46);(50,47);(50,48);(50,49);(50,50);(50,51);(50,52);(50,53);(50,54);(50,55);(50,56);(50,57);(50,58);(50,59);(50,60);(50,61);(50,62);(50,63);(50,64);(50,65);(50,66);(50,67);(50,68);(50,69);(50,70);(50,71);(50,72);(50,73);(50,74);(50,75);(50,76);(50,77);(50,78);(50,79);(51,79);(52,79);(53,79);(54,79);(54,78);(54,77);(54,76);(54,75);(54,74);(54,73);(54,72);(54,71);(54,70);(54,69);(54,68);(54,67);(54,66);(54,65);(54,64);(54,63);(54,62);(54,61);(54,60);(54,59);(54,58);(54,57);(54,56);(54,55);(54,54);(54,53);(54,52);(54,51);(54,50);(54,49);(54,48);(54,47);(54,46);(54,45);(54,44);(54,43);(54,42);(54,41);(54,40);(54,39);(54,38);(54,37);(54,36);(54,35);(54,34);(54,33);(54,32);(54,31);(54,30);(54,29);(54,28);(54,27);(54,26);(54,25);(54,24);(54,23);(54,22);(54,21);(54,20);(54,19);(54,18);(54,17);(54,16);(54,15);(54,14);(54,13);(54,12);(54,11);(54,10);(54,9);(54,8);(54,7);(54,6);(54,5);(54,4);(54,3);(54,2);(54,1);(54,0);(53,0);(52,0);(51,0)");
    ArrayList <CStop> stops = new ArrayList<>();

    public void Sim (){
        System.out.println("Hello world!");
        obj.add(line1);
        obj.add(line4);
        obj.add(line10);
        obj.add(line3);
        jFrame = new CJFrame(trams);
        jFrame.guiPanel.objects = obj;
        jFrame.guiPanel.readMap();
        Timer timer = new Timer(100,new CTimer(this));
        timer.start();
        createStop();
  }

  public void createStop(){
      CStop stop = new CPlatform("(5,19)","(6,19)",trams);
      obj.add(stop);
      stops.add(stop);
      stop = new CLoop("(51,6);(51,5);(51,4);(51,3);(51,2)","(50,6)",trams,line3);
      obj.add(stop);
      stops.add(stop);
      stop = new CStop("(53,6)","(54,6)",trams);
      obj.add(stop);
      stops.add(stop);
      stop = new CStop("(51,22)","(50,22)",trams);
      obj.add(stop);
      stops.add(stop);
      stop = new CStop("(51,38)","(50,38)",trams);
      obj.add(stop);
      stops.add(stop);
      stop = new CStop("(51,54)","(50,54)",trams);
      obj.add(stop);
      stops.add(stop);
      stop = new CStop("(51,70)","(50,70)",trams);
      obj.add(stop);
      stops.add(stop);
      System.err.println(stops.size());

      stop = new CTrafficLights("(51,60)","(50,60)",trams,0);
      obj.add(stop);
      stops.add(stop);

      stop = new CTrafficLights("(51,10)","(50,10)",trams,30);
      obj.add(stop);
      stops.add(stop);

  }
}

class CTimer implements ActionListener {
    int currentTime = 0;
    CSimulator simtimer = null;
    CTimer(CSimulator s){
        this.simtimer = s;
     /*   simtimer.addTram(simtimer.line3,5);
        simtimer.addTram(simtimer.line3,15);
        simtimer.addTram(simtimer.line3,25);
        simtimer.addTram(simtimer.line3,35);
    */}

    @Override
    public void actionPerformed(ActionEvent e) {
   /*     if(currentTime %100  == 0){
            simtimer.addTram(simtimer.line1);
            simtimer.addTram(simtimer.line10);
            simtimer.addTram(simtimer.line4);
            simtimer.addTram(simtimer.line3);
        }*/
        currentTime++;
        System.out.println(currentTime);
        for(int i = simtimer.trams.size()-1 ;i>=0;i-- ){
            CTram t=simtimer.trams.get(i);
            t.move();
        }
        for(CStop s: simtimer.stops){
            s.stopTram(currentTime);
        }
        simtimer.jFrame.guiPanel.repaint();
    }
}
